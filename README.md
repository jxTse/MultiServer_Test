# ServerTestComparer
compare test results from different servers

## 题目
比对两台服务器测试结果的C++程序

## 创建者
XIE Jinxiang

## 创建日期
2023年8月3日

## 版本修订日期
- 2023年8月3日: 版本1.0

## 功能描述
本程序旨在通过在本地PC上执行C++代码，分别连接x86服务器和泰山服务器，将测试数据集从本地PC传输到这两台服务器作为输入，然后分别调用两台服务器上的程序，将测试结果文件传输回本地PC，并进行比较，以验证测试结果的一致性。程序的功能主要包括以下几个方面：

1. 生成测试数据集：本地PC上生成测试数据集，将其保存为二进制文件，并传输到x86服务器和泰山服务器上作为输入。

2. 连接服务器：本地PC分别连接x86服务器和泰山服务器，通过TCP协议与两台服务器建立连接。

3. 执行测试程序：在x86服务器和泰山服务器上分别执行测试程序，将测试结果保存为二进制文件。

4. 传输测试结果：将x86服务器和泰山服务器上的测试结果文件传输回本地PC。

5. 比较测试结果：将两个测试结果文件逐字节比较，判断测试结果是否一致。

## 设计流程描述
1. 在本地PC上生成测试数据集，并保存为名为"test_dataset.bin"的二进制文件。

2. 本地PC分别连接x86服务器和泰山服务器，并将测试数据集传输到这两台服务器上。

3. 在x86服务器和泰山服务器上，分别执行与测试数据集相关的测试程序，并将测试结果保存为名为"x86_test_result.bin"和"taishan_test_result.bin"的二进制文件。

4. 两台服务器将测试结果文件传输回本地PC。

5. 本地PC接收x86服务器和泰山服务器传回的测试结果文件。

6. 逐字节比较"x86_test_result.bin"和"taishan_test_result.bin"两个文件，判断测试结果是否一致。

7. 打印比较结果，如果两个文件完全相同，则说明测试结果一致，比较通过；否则，说明测试结果不一致，比较未通过。

## 使用步骤说明

1. 在x86端新建X86_Server.cpp文件，输入g++ X86_Server.cpp，编译完成后输入./X86_Server命令开始等待连接。

2. 在arm端新建TAISHAN_Server.cpp文件，输入g++ TAISHAN_Server.cpp，编译完成后输入./TAISHAN_Server命令开始等待连接。

3. 在本地机编译并运行test.cpp文件。

4. 运行test文件开始运行脚本。

## 结果比对信息说明
在本地PC上，我们通过逐字节比较"x86_test_result.bin"和"taishan_test_result.bin"两个文件来判断测试结果是否一致。如果两个文件完全相同，说明测试结果一致，比较通过；否则，说明测试结果不一致，比较未通过。

对于浮点数的比较，我们使用了C++标准库中的math.isclose函数，以避免由于浮点数误差而导致的比较失败。同时，为了保证绝对精确的比较，我们在服务器端使用C语言将浮点数转换成16进制数，并将16进制数保存在二进制文件中，以便在本地PC上进行比较。

比较通过的结果将打印“两个测试结果文件相同，比较通过！”的信息，比较未通过的结果将打印“两个测试结果文件不相同，比较未通过！”的信息。

## 注意事项
1. 请确保本地PC、x86服务器和泰山服务器均已正确配置VPN，并可以相互访问。

2. 请在x86服务器和泰山服务器上编译和部署相应的测试程序，并确保程序可以正确执行并生成测试结果文件。

3. 在传输文件时，请确保文件名和路径设置正确，以便程序正确接收和发送文件。

4. 为了保证测试结果的准确性，请确保两台服务器上的测试环境和参数设置一致。

## 结论
本程序通过在本地PC上执行C++代码，分别连接x86服务器和泰山服务器，并进行测试结果的比较，验证了测试结果的一致性。在测试过程中，我们使用了C语言将浮点数转换成16进制数，以避免浮点数误差导致的比较失败。通过合理的设计流程和比对方法，确保了测试结果的可靠性和准确性。在实际应用中，本程序可用于验证两台服务器的测试结果是否一致，为系统性能和功能测试提供有效的支持。
